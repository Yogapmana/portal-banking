{
	"info": {
		"_postman_id": "banking-portal-api",
		"name": "Banking Portal API",
		"description": "Complete API collection for Banking Portal project with authentication and customer management endpoints",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "token",
			"value": "",
			"type": "string"
		},
		{
			"key": "userId",
			"value": "",
			"type": "string"
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{token}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"exec": [
					""
				],
				"type": "text/javascript"
			}
		},
		{
			"listen": "test",
			"script": {
				"exec": [
					""
				],
				"type": "text/javascript"
			}
		}
	],
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "User Registration",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has required fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData).to.have.property('user');",
									"    pm.expect(jsonData).to.have.property('token');",
									"});",
									"",
									"pm.test(\"User object has required fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.user).to.have.property('id');",
									"    pm.expect(jsonData.user).to.have.property('email');",
									"});",
									"",
									"// Store token and userId for subsequent requests",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.collectionVariables.set('token', jsonData.token);",
									"    pm.collectionVariables.set('userId', jsonData.user.id.toString());",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"testuser@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"register"
							]
						},
						"description": "Register a new user account. Returns JWT token and user data upon successful registration."
					},
					"response": []
				},
				{
					"name": "User Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has required fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData).to.have.property('user');",
									"    pm.expect(jsonData).to.have.property('token');",
									"});",
									"",
									"pm.test(\"Success message is correct\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.message).to.eql(\"Login berhasil\");",
									"});",
									"",
									"// Store token and userId for subsequent requests",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.collectionVariables.set('token', jsonData.token);",
									"    pm.collectionVariables.set('userId', jsonData.user.id.toString());",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"testuser@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						},
						"description": "Authenticate user and return JWT token. Use the same credentials from registration."
					},
					"response": []
				}
			],
			"description": "Authentication endpoints for user registration and login"
		},
		{
			"name": "Customer Management",
			"item": [
				{
					"name": "Get All Customers (with pagination)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has required structure\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('customers');",
									"    pm.expect(jsonData).to.have.property('pagination');",
									"    pm.expect(jsonData.customers).to.be.an('array');",
									"});",
									"",
									"pm.test(\"Pagination object has required fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.pagination).to.have.property('currentPage');",
									"    pm.expect(jsonData.pagination).to.have.property('totalPages');",
									"    pm.expect(jsonData.pagination).to.have.property('totalCustomers');",
									"    pm.expect(jsonData.pagination).to.have.property('limit');",
									"    pm.expect(jsonData.pagination).to.have.property('hasNext');",
									"    pm.expect(jsonData.pagination).to.have.property('hasPrev');",
									"});",
									"",
									"pm.test(\"Customers array has valid objects\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.customers.length > 0) {",
									"        const customer = jsonData.customers[0];",
									"        pm.expect(customer).to.have.property('id');",
									"        pm.expect(customer).to.have.property('name');",
									"        pm.expect(customer).to.have.property('phoneNumber');",
									"        pm.expect(customer).to.have.property('score');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/customers/?page=1&limit=20&sortBy=score&sortOrder=desc",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"customers",
								""
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "Page number for pagination"
								},
								{
									"key": "limit",
									"value": "20",
									"description": "Number of items per page"
								},
								{
									"key": "sortBy",
									"value": "score",
									"description": "Field to sort by (default: score)"
								},
								{
									"key": "sortOrder",
									"value": "desc",
									"description": "Sort order: asc or desc (default: desc)"
								}
							]
						},
						"description": "Retrieve all customers with pagination and sorting options"
					},
					"response": []
				},
				{
					"name": "Search Customers",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has required structure\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('customers');",
									"    pm.expect(jsonData).to.have.property('pagination');",
									"});",
									"",
									"pm.test(\"Search results match search term\", function () {",
									"    const jsonData = pm.response.json();",
									"    const searchTerm = pm.request.url.query.get('search');",
									"    if (searchTerm && jsonData.customers.length > 0) {",
									"        const searchLower = searchTerm.toLowerCase();",
									"        const matches = jsonData.customers.some(customer => {",
									"            return customer.name.toLowerCase().includes(searchLower) ||",
									"                   customer.phoneNumber.includes(searchLower) ||",
									"                   (customer.job && customer.job.toLowerCase().includes(searchLower));",
									"        });",
									"        pm.expect(matches).to.be.true;",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/customers/?search=john&page=1&limit=10",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"customers",
								""
							],
							"query": [
								{
									"key": "search",
									"value": "john",
									"description": "Search term to find customers by name, phone, or job"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								}
							]
						},
						"description": "Search customers by name, phone number, or job"
					},
					"response": []
				},
				{
					"name": "Filter Customers by Multiple Criteria",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has required structure\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('customers');",
									"    pm.expect(jsonData).to.have.property('pagination');",
									"});",
									"",
									"pm.test(\"Filters are applied correctly\", function () {",
									"    const jsonData = pm.response.json();",
									"    const minScore = parseInt(pm.request.url.query.get('minScore'));",
									"    const maxScore = parseInt(pm.request.url.query.get('maxScore'));",
									"    const jobFilter = pm.request.url.query.get('job');",
									"    ",
									"    if (jsonData.customers.length > 0) {",
									"        jsonData.customers.forEach(customer => {",
									"            if (minScore) pm.expect(customer.score).to.be.at.least(minScore);",
									"            if (maxScore) pm.expect(customer.score).to.be.at.most(maxScore);",
									"            if (jobFilter) pm.expect(customer.job).to.eql(jobFilter);",
									"        });",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/customers/?minScore=400&maxScore=800&job=technician&marital=single&education=secondary&housing=yes&page=1&limit=20",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"customers",
								""
							],
							"query": [
								{
									"key": "minScore",
									"value": "400",
									"description": "Minimum credit score filter"
								},
								{
									"key": "maxScore",
									"value": "800",
									"description": "Maximum credit score filter"
								},
								{
									"key": "job",
									"value": "technician",
									"description": "Filter by job type"
								},
								{
									"key": "marital",
									"value": "single",
									"description": "Filter by marital status"
								},
								{
									"key": "education",
									"value": "secondary",
									"description": "Filter by education level"
								},
								{
									"key": "housing",
									"value": "yes",
									"description": "Filter by housing status"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "20"
								}
							]
						},
						"description": "Filter customers by multiple criteria including score range, job, marital status, education, and housing"
					},
					"response": []
				},
				{
					"name": "Get Customer by ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has required customer fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    const requiredFields = ['id', 'originalId', 'name', 'phoneNumber', 'score', 'age', 'job', 'marital', 'education', 'housing', 'loan', 'contact', 'month', 'duration', 'campaign', 'pdays', 'previous', 'poutcome'];",
									"    ",
									"    requiredFields.forEach(field => {",
									"        pm.expect(jsonData).to.have.property(field);",
									"    });",
									"});",
									"",
									"pm.test(\"Customer ID matches request\", function () {",
									"    const jsonData = pm.response.json();",
									"    const requestedId = parseInt(pm.request.url.path.pop());",
									"    pm.expect(jsonData.id).to.eql(requestedId);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/customers/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"customers",
								"1"
							]
						},
						"description": "Retrieve a specific customer by their ID. Replace '1' with the actual customer ID."
					},
					"response": []
				},
				{
					"name": "Get Customer by Invalid ID (404 Test)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404\", function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test(\"Error message is returned\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('not found');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/customers/99999",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"customers",
								"99999"
							]
						},
						"description": "Test 404 error when customer ID doesn't exist"
					},
					"response": []
				},
				{
					"name": "Get Filter Options",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has required filter options\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('jobOptions');",
									"    pm.expect(jsonData).to.have.property('maritalOptions');",
									"    pm.expect(jsonData).to.have.property('educationOptions');",
									"    pm.expect(jsonData).to.have.property('housingOptions');",
									"    pm.expect(jsonData).to.have.property('scoreRange');",
									"});",
									"",
									"pm.test(\"Score range has required fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.scoreRange).to.have.property('min');",
									"    pm.expect(jsonData.scoreRange).to.have.property('max');",
									"    pm.expect(jsonData.scoreRange).to.have.property('avg');",
									"});",
									"",
									"pm.test(\"Options are arrays\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.jobOptions).to.be.an('array');",
									"    pm.expect(jsonData.maritalOptions).to.be.an('array');",
									"    pm.expect(jsonData.educationOptions).to.be.an('array');",
									"    pm.expect(jsonData.housingOptions).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/customers/filters/options",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"customers",
								"filters",
								"options"
							]
						},
						"description": "Get all available filter options for customer search including distinct values and score statistics"
					},
					"response": []
				}
			],
			"description": "Customer management endpoints with search, filtering, and pagination capabilities"
		},
		{
			"name": "System",
			"item": [
				{
					"name": "API Health Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has correct message\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.eql('API berjalan!');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api"
							]
						},
						"description": "Basic health check endpoint to verify API is running"
					},
					"response": []
				}
			],
			"description": "System and utility endpoints"
		}
	]
}